<sds-top-banner></sds-top-banner>

<header class="usa-header usa-header--extended" role="banner">
  <div class="usa-navbar">
    <div class="usa-logo" id="extended-logo">
      <em class="usa-logo__text"><a [routerLink]="model.home.route" title="Home"
          aria-label="Home">{{model.home.text}}</a></em>
    </div>
    <button class="usa-menu-btn" aria-label="Menu">
      <fa-layers [fixedWidth]="true" size="3x">
        <fa-icon [icon]="['fas', 'square']" [classes]="['icon-square']"></fa-icon>
        <fa-icon [icon]="['sam', 'bars']" [classes]="['icon-bars']" transform="shrink-6"></fa-icon>
        <fa-layers-counter *ngIf="hasCounter()" [classes]="['icon-layers-counter']"></fa-layers-counter>
      </fa-layers>
    </button>
  </div>
  <nav role="navigation" class="usa-nav">
    <div class="usa-nav__inner">
      <button class="usa-nav__close" aria-label="Close">
        <fa-layers [fixedWidth]="true" size="2x">
          <fa-icon [icon]="['fas', 'square']" [classes]="['icon-square']"></fa-icon>
          <fa-icon [icon]="['sam', 'arrow-left']" [classes]="['icon-arrow-left']" transform="shrink-6"></fa-icon>
        </fa-layers>
      </button>
      <ul class="usa-nav__primary usa-accordion">
        <li *ngFor="let link of model.navigationLinks" class="usa-nav__primary-item">
          <ng-container [ngTemplateOutlet]="link.route ? linkTemplate : dropDownTemplate"
            [ngTemplateOutletContext]="{$implicit:link}"></ng-container>
        </li>
      </ul>
      <div class="usa-nav__secondary">
        <ul class="usa-nav__secondary-links">
          <li *ngFor="let link of model.secondaryLinks" class="usa-nav__secondary-item">
            <ng-container
              [ngTemplateOutlet]="isLinkInternal(link)  ? secondaryRouteLinkTemplate :   isLinkExternal(link)? secondaryHREFLinkTemplate : secondaryEVENTLinkTemplate"
              [ngTemplateOutletContext]="{$implicit:link}"></ng-container>
          </li>
        </ul>
      </div>
    </div>
  </nav>
</header>

<ng-template #secondaryRouteLinkTemplate let-link>
  <a [routerLink]="[link.route]" [attr.class]="link.selected ? 'usa-current' :''">
    <ng-container [ngTemplateOutlet]="iconLinkTemplate" [ngTemplateOutletContext]="{$implicit:link}">
    </ng-container>
  </a>
</ng-template>


<ng-template #secondaryHREFLinkTemplate let-link>
  <a [attr.href]="[link.route]" [attr.class]="link.selected ? 'usa-current' :''">
    <ng-container [ngTemplateOutlet]="iconLinkTemplate" [ngTemplateOutletContext]="{$implicit:link}">
    </ng-container>
  </a>
</ng-template>


<ng-template #secondaryEVENTLinkTemplate let-link>
  <a (click)="linkClickEvent(link)" href="javascript:void(0)" [attr.class]="link.selected ? 'usa-current' :''">
    <ng-container [ngTemplateOutlet]="iconLinkTemplate" [ngTemplateOutletContext]="{$implicit:link}">
    </ng-container>
  </a>
</ng-template>


<ng-template #iconLinkTemplate let-link>
  <fa-layers [fixedWidth]="true">
    <fa-icon [icon]="[link.imageClassPrefix, link.imageClass]"></fa-icon>
    <fa-layers-counter *ngIf="link.hasCounter" [classes]="['icon-layers-counter']"></fa-layers-counter>
  </fa-layers>
  {{link.text}}
</ng-template>

<ng-template #linkTemplate let-link>
  <ng-container
    [ngTemplateOutlet]="isLinkInternal(link)  ? linkRouteTemplate : isLinkExternal(link)? linkHREFTemplate : linkEventTemplate "
    [ngTemplateOutletContext]="{$implicit:link}"></ng-container>
</ng-template>

<ng-template #linkRouteTemplate let-link>
  <a [attr.class]="link.selected ? 'usa-nav__link usa-current' : 'usa-nav__link'"
    [routerLink]="[link.route]"><span>{{link.text}}</span></a>
</ng-template>

<ng-template #linkHREFTemplate let-link>
  <a [attr.class]="link.selected ? 'usa-nav__link usa-current' : 'usa-nav__link'"
    [attr.href]="[link.route]"><span>{{link.text}}</span></a>
</ng-template>

<ng-template #linkEventTemplate let-link>
  <a [attr.class]="link.selected ? 'usa-nav__link usa-current' : 'usa-nav__link'" href="javascript:void(0)"
    (click)="linkClickEvent(link)"><span>{{link.text}}</span></a>
</ng-template>

<ng-template #dropDownTemplate let-link>
  <button
    [attr.class]="link.selected ? 'usa-accordion__button usa-nav__link usa-current' : 'usa-accordion__button usa-nav__link'"
    aria-expanded="false" [attr.aria-controls]="removeWhiteSpace(link.text)+'-section'">
    <span>{{link.text}}</span>
  </button>
  <ul [attr.id]="removeWhiteSpace(link.text)+'-section'" class="usa-nav__submenu" hidden>
    <li *ngFor="let childLink of link.children" class="usa-nav__submenu-item">
      <a [routerLink]="[childLink.route]">{{childLink.text}}</a>
    </li>
  </ul>
</ng-template>